**爬蟲練習**

**說明:**
在不使用任何瀏覽器自動化工具（如Selenium、Webdriver等）的情況下，<br>
在[公開資訊觀測站](https://mops.twse.com.tw/mops/web/t51sb10_q1)，進行條件式重訊搜索，<br>
並取得符合條件的指定資料 (6414 樺漢/發言日期:112/07/06) 之詳細資料，其中14項指定欄位內容<br>

**條件:** <br>
1. 上市公司
2. 112年全年度
3. 關鍵字:轉換公司債

**詳細資料指定欄位內容**:待補充<br>

**進度:**
1. 已抓取符合條件的搜尋內容(search.py)<br>
2. ~~抓不到指定資料的詳細資料內容(details.py)~~ 已獲取詳細資料<br> 
3. 已整理獲取內容、印出要求資訊如下(details.py)<br>

1.股票代號: 6414 <br>
2.股票名稱: 樺漢 <br>
3.上市/上櫃: 第五次無擔保 <br>
4.決議日期:  董事會決議日期:112/07/06<br>
5.發行總額:  新台幣30億元整為上限<br>
6.發行價格:  發行價格:依票面金額之100%~101%發行<br>
7.發行期間:  發行期間:3年<br>
8.擔保品:  擔保品之種類、名稱、金額及約定事項:不適用<br>
9.發行用途:  募得價款之用途及運用計畫:償還銀行借款<br>
10.承銷方式:  承銷方式:以詢價圈購方式全數對外公開承銷<br>
11.受託人:  公司債受託人:永豐商業銀行股份有限公司<br>
12.承銷:  承銷或代銷機構:凱基證券股份有限公司<br>
13.轉換基準日:  附有轉換、交換或認股者，其換股基準日: 相關轉換辦法將依有關法令<br>
辦理，並報准證券主管機關後另行公告<br>

**遇到的困難與嘗試方法:** <br>
遇到的困難(更新:已獲取跳轉視窗內容，也就是詳細資料): <br>
~~用requests POST方法，以及在網頁上找到的payloads內容和ajax請求網址，~~<br>
~~無法抓到資料，因為使用者點擊網頁按鈕後會跳出新視窗~~<br>
~~network裡看不到跳轉視窗網址~~<br>

**獲取跳轉視窗內容作法：**<br>
1.觀察HTML結構：<br>
搜尋結果頁面找到form（看到POST方法、ajax請求地址），<br>
form內包含input和table兩個元素，它們處於相同的層級。<br>
input元素包含參數格式(有原始搜尋條件values)，<br>
而table元素則包含"詳細資料"按鈕（其onclick事件記載了詳細參數）。

2.將詳細參數放入參數格式，作為payload，並使用POST方法發送請求。

3.將資料存成 詳細資料.csv



